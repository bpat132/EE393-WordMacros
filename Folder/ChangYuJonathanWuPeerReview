The following tests were performed.

-Empty text document
-3 paragraph Loren Ipsum
-5 paragraph Loren Ipsum

Your code past all three tests.

You should consider adding comments to your macro. This should include your (author) name.

The macro should be cleaned up. Your uploaded version contains defunct macros. I have deleted them.
